================================================================================
                    ğŸ” TESTE DE DEBUG - VERIFICAR TEMPLATE
================================================================================

Adicionei um debug na view que serve os templates. Agora vamos testar!

================================================================================
                    ğŸ“‹ PASSO A PASSO PARA TESTAR
================================================================================

PASSO 1: REINICIAR O SERVIDOR DJANGO

1. Pare o servidor Django (Ctrl+C)
2. Reinicie:
   cd backend
   python manage.py runserver

IMPORTANTE: Mantenha o terminal do Django aberto para ver os logs!

PASSO 2: BAIXAR O TEMPLATE

1. Acesse http://localhost:5173
2. VÃ¡ em "Empresas"
3. Clique em "Baixar Template"
4. O arquivo serÃ¡ baixado

PASSO 3: VERIFICAR OS LOGS

Olhe no terminal do Django e procure por uma linha que comeÃ§a com:
"DEBUG: Template companies - CabeÃ§alhos:"

VocÃª verÃ¡ algo como:
DEBUG: Template companies - CabeÃ§alhos: ['CÃ³digo', 'RazÃ£o Social', 'CNPJ', ...]

SE VOCÃŠ VER:
âœ… ['CÃ³digo', 'RazÃ£o Social', 'CNPJ', ...]
   â†’ Template estÃ¡ CORRETO no servidor!

âŒ ['Nome da Empresa', 'CNPJ', ...]
   â†’ Template estÃ¡ INCORRETO no servidor!

PASSO 4: VERIFICAR O ARQUIVO BAIXADO

Abra o arquivo baixado no Excel e verifique a primeira coluna.

================================================================================
                    ğŸ¯ RESULTADOS ESPERADOS
================================================================================

LOGS DO DJANGO (terminal):
DEBUG: Template companies - CabeÃ§alhos: ['CÃ³digo', 'RazÃ£o Social', 'CNPJ', 'Nome Fantasia', 'E-mail', 'Telefone', 'EndereÃ§o', 'ResponsÃ¡vel']

ARQUIVO EXCEL BAIXADO:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CÃ³digo   â”‚ RazÃ£o Social         â”‚ CNPJ             â”‚ Nome Fantasia   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EMP001   â”‚ Empresa Exemplo Ltda â”‚ 12345678000190   â”‚ Exemplo         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PRIMEIRA COLUNA: "CÃ³digo" âœ“

================================================================================
                    ğŸ”§ SE OS LOGS MOSTRAREM TEMPLATE INCORRETO
================================================================================

Se os logs mostrarem que o template no servidor estÃ¡ incorreto,
execute este comando para recriar o template:

python -c "import os; from openpyxl import Workbook; os.makedirs('backend/media/templates', exist_ok=True); wb = Workbook(); ws = wb.active; ws.append(['CÃ³digo', 'RazÃ£o Social', 'CNPJ', 'Nome Fantasia', 'E-mail', 'Telefone', 'EndereÃ§o', 'ResponsÃ¡vel']); ws.append(['EMP001', 'Empresa Exemplo Ltda', '12345678000190', 'Exemplo', 'contato@exemplo.com', '(11) 99999-9999', 'Rua Exemplo, 123', 'JoÃ£o Silva']); ws.column_dimensions['A'].width = 15; ws.column_dimensions['B'].width = 40; ws.column_dimensions['C'].width = 18; ws.column_dimensions['D'].width = 30; ws.column_dimensions['E'].width = 30; ws.column_dimensions['F'].width = 18; ws.column_dimensions['G'].width = 40; ws.column_dimensions['H'].width = 25; wb.save('backend/media/templates/template_empresas.xlsx'); print('Template criado!')"

Depois reinicie o servidor novamente.

================================================================================
                    ğŸ”§ SE OS LOGS MOSTRAREM TEMPLATE CORRETO MAS O ARQUIVO BAIXADO ESTIVER ERRADO
================================================================================

Isso significa que hÃ¡ cache do navegador ou do Django.

SOLUÃ‡ÃƒO 1: Limpar cache do navegador
- Pressione Ctrl+Shift+Del
- Selecione "Imagens e arquivos em cache"
- Limpe os dados

SOLUÃ‡ÃƒO 2: Baixar em modo anÃ´nimo
- Abra uma janela anÃ´nima (Ctrl+Shift+N)
- Acesse http://localhost:5173
- Baixe o template

SOLUÃ‡ÃƒO 3: Baixar diretamente da API
- Acesse: http://localhost:8000/api/download-template/companies/
- O arquivo serÃ¡ baixado diretamente da API

================================================================================
                    ğŸ“ CHECKLIST
================================================================================

- [ ] Servidor Django reiniciado
- [ ] Terminal do Django aberto e visÃ­vel
- [ ] Template baixado pelo sistema
- [ ] Logs verificados no terminal
- [ ] Arquivo baixado aberto no Excel
- [ ] Primeira coluna verificada

================================================================================
                    ğŸ“ ME ENVIE ESTAS INFORMAÃ‡Ã•ES
================================================================================

ApÃ³s fazer o teste, me envie:

1. O que apareceu nos logs do Django (linha com "DEBUG: Template companies")
2. Qual Ã© a primeira coluna do arquivo baixado
3. Se o problema persiste

Com essas informaÃ§Ãµes posso identificar exatamente onde estÃ¡ o problema!

================================================================================

                    FAÃ‡A O TESTE E ME ENVIE OS RESULTADOS! ğŸ”

================================================================================

